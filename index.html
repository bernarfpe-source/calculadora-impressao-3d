<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CALCULADORA 3D - IOS EDITION</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üñ®Ô∏è</text></svg>" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-font-smoothing: antialiased; }
    body { 
      background: #000000; 
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text", "Helvetica Neue", sans-serif; 
      color: #FFFFFF;
      line-height: 1.4;
    }
    /* SCROLLBAR ESTILO IOS */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: #000000; }
    ::-webkit-scrollbar-thumb { background: #38383A; border-radius: 10px; }
    
    input[type="range"] {
      -webkit-appearance: none;
      width: 100%;
      height: 4px;
      background: #38383A;
      border-radius: 2px;
      accent-color: #0A84FF;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
  <script type="text/babel">
    const { useState, useMemo, useEffect, useCallback } = React;

    const SK = "print3d-archive";
    async function ldA() { try { const v = localStorage.getItem(SK); return v ? JSON.parse(v) : []; } catch { return []; } }
    async function svA(items) { try { localStorage.setItem(SK, JSON.stringify(items)); } catch(e) { console.error(e); } }

    const materialData = {
      PLA: { pricePerKg: 120, density: 1.24, description: "MAIS COMUM, F√ÅCIL" },
      ABS: { pricePerKg: 140, density: 1.04, description: "RESISTENTE, INDUSTRIAL" },
      PETG: { pricePerKg: 150, density: 1.27, description: "RESISTENTE E FLEX√çVEL" },
      TPU: { pricePerKg: 200, density: 1.21, description: "FLEX√çVEL, BORRACHUDO" },
      RESINA: { pricePerKg: 250, density: 1.10, description: "ALTA DEFINI√á√ÉO" },
    };

    const marketplacePresets = {
      NENHUM: { label: "VENDA DIRETA", taxa: 0, desc: "SEM MARKETPLACE" },
      ML: { label: "MERCADO LIVRE", taxa: 13, desc: "~11-16% TAXA" },
      SHOPEE: { label: "SHOPEE", taxa: 14, desc: "~12-18% TAXA" },
      AMAZON: { label: "AMAZON", taxa: 15, desc: "~8-20% TAXA" },
    };

    const statusOptions = [
      { id: "verificada", label: "VERIFICADA", color: "#30D158", icon: "‚úÖ" },
      { id: "pendente", label: "PENDENTE", color: "#FFD60A", icon: "‚è≥" },
      { id: "problema", label: "PROBLEMA", color: "#FF453A", icon: "‚ö†Ô∏è" },
    ];

    function NI({ label, value, onChange, unit, step = 1, min = 0, helpText }) {
      return (
        <div style={{ marginBottom: 20 }}>
          <label style={{ display: "block", fontSize: 12, fontWeight: "600", color: "#8E8E93", marginBottom: 8, letterSpacing: "0.5px" }}>{label}</label>
          <div style={{ display: "flex", alignItems: "center", background: "#1C1C1E", borderRadius: 10, padding: "4px 12px", border: "0.5px solid #38383A" }}>
            <input type="number" value={value} onChange={(e) => onChange(parseFloat(e.target.value) || 0)} step={step} min={min}
              style={{ flex: 1, background: "transparent", border: "none", color: "#FFFFFF", fontSize: 17, padding: "10px 0", outline: "none" }} />
            {unit && <span style={{ color: "#8E8E93", fontSize: 15 }}>{unit}</span>}
          </div>
        </div>
      );
    }

    function CC({ label, value, icon, color = "#0A84FF", sub }) {
      return (
        <div style={{ background: "#1C1C1E", borderRadius: 14, padding: "16px", border: "0.5px solid #38383A", flex: 1, minWidth: "140px" }}>
          <div style={{ fontSize: 20, marginBottom: 8 }}>{icon}</div>
          <div style={{ fontSize: 11, color: "#8E8E93", fontWeight: "600", marginBottom: 4 }}>{label}</div>
          <div style={{ fontSize: 19, fontWeight: "800", color }}>{value}</div>
          {sub && <div style={{ fontSize: 10, color: "#636366", marginTop: 4 }}>{sub}</div>}
        </div>
      );
    }

    function App() {
      const [pg, sPg] = useState(50), [th, sTh] = useState(4), [tm, sTm] = useState(30), [mat, sMat] = useState("PLA");
      const [ci, sCi] = useState(3000), [vu, sVu] = useState(5000), [pw, sPw] = useState(250), [ckw, sCkw] = useState(0.85);
      const [inf, sInf] = useState(20), [fp, sFp] = useState(5);
      const [lix, sLix] = useState(false), [pin, sPin] = useState(false), [acab, sAcab] = useState(false), [sup, sSup] = useState(true);
      const [vhm, sVhm] = useState(30), [tsu, sTsu] = useState(15), [tpp, sTpp] = useState(20);
      const [ml, sMl] = useState(50), [qtd, sQtd] = useState(1), [cfm, sCfm] = useState(200), [hm, sHm] = useState(200);
      const [ff, sFf] = useState(15), [fpc, sFpc] = useState(true), [ce, sCe] = useState(3);
      const [rt, sRt] = useState("mei"), [ac, sAc] = useState(6), [mk, sMk] = useState("NENHUM");
      const [tab, sTab] = useState("peca"), [arch, sArch] = useState([]), [nome, sNome] = useState("");

      const f = v => `R$ ${v.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;

      const c = useMemo(() => {
        const m = materialData[mat] || materialData.PLA, tH = th + tm / 60;
        const cMat = (pg / 1000) * m.pricePerKg, cEn = (pw / 1000) * tH * ckw, dep = (ci / vu) * tH;
        const cMdo = ((tsu + tpp) / 60) * vhm;
        let cPos = 0; if (lix) cPos += 2.5; if (pin) cPos += 8; if (acab) cPos += 5; if (sup) cPos += 1.5;
        const cFalha = (cMat + cEn) * (fp / 100), rCF = (cfm / hm) * tH;
        const cProd = cMat + cEn + dep + cMdo + cPos + cFalha + rCF + ce + (fpc ? 0 : ff);
        const pBase = cProd * (1 + ml / 100);
        const tTx = (mk === "NENHUM" ? 0 : marketplacePresets[mk].taxa / 100) + (rt === "mei" ? 0.05 : 0.07);
        const pFin = pBase / (1 - tTx);
        return { cProd, cTot: cProd, pVenda: pFin, lucro: pFin - cProd, mReal: ((pFin - cProd) / pFin) * 100 };
      }, [pg, th, tm, mat, ci, vu, pw, ckw, fp, lix, pin, acab, sup, vhm, tsu, tpp, ml, cfm, hm, ff, fpc, ce, rt, mk]);

      return (
        <div style={{ maxWidth: 500, margin: "0 auto", padding: "20px" }}>
          <header style={{ textAlign: "center", marginBottom: 30 }}>
            <h1 style={{ fontSize: 22, fontWeight: "800", letterSpacing: "-0.5px" }}>CALCULADORA 3D</h1>
            <p style={{ fontSize: 12, color: "#8E8E93", marginTop: 4 }}>ESTILO IOS DARK MODE</p>
          </header>

          <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 12, marginBottom: 25 }}>
            <CC icon="üè∑Ô∏è" label="PRE√áO VENDA" value={f(c.pVenda)} color="#0A84FF" />
            <CC icon="üìà" label="LUCRO L√çQUIDO" value={f(c.lucro)} color="#30D158" sub={`${c.mReal.toFixed(1)}% MARGEM`} />
          </div>

          <nav style={{ display: "flex", gap: 8, marginBottom: 25, overflowX: "auto", paddingBottom: 10 }}>
            {[["peca", "PE√áA"], ["custos", "OPERA√á√ÉO"], ["mdo", "LABOR"]].map(([id, label]) => (
              <button key={id} onClick={() => sTab(id)} style={{
                padding: "8px 16px", borderRadius: 20, border: "none", fontSize: 12, fontWeight: "700",
                background: tab === id ? "#0A84FF" : "#1C1C1E", color: "#FFF", whiteSpace: "nowrap"
              }}>{label}</button>
            ))}
          </nav>

          <div style={{ background: "#1C1C1E", borderRadius: 20, padding: "24px", border: "0.5px solid #38383A" }}>
            {tab === "peca" && (
              <>
                <NI label="PESO ESTIMADO (G)" value={pg} onChange={sPg} unit="G" />
                <div style={{ display: "flex", gap: 15 }}>
                  <div style={{ flex: 1 }}><NI label="HORAS" value={th} onChange={sTh} unit="H" /></div>
                  <div style={{ flex: 1 }}><NI label="MINUTOS" value={tm} onChange={sTm} unit="M" /></div>
                </div>
                <label style={{ display: "block", fontSize: 12, fontWeight: "600", color: "#8E8E93", marginBottom: 12 }}>MATERIAL</label>
                <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 8 }}>
                  {Object.keys(materialData).map(m => (
                    <button key={m} onClick={() => sMat(m)} style={{
                      padding: "12px", borderRadius: 12, border: mat === m ? "2px solid #0A84FF" : "1px solid #38383A",
                      background: mat === m ? "rgba(10, 132, 255, 0.1)" : "transparent", color: "#FFF", fontSize: 12, fontWeight: "700"
                    }}>{m}</button>
                  ))}
                </div>
              </>
            )}

            {tab === "custos" && (
              <>
                <NI label="CUSTO DA M√ÅQUINA" value={ci} onChange={sCi} unit="R$" />
                <NI label="POT√äNCIA M√âDIA" value={pw} onChange={sPw} unit="W" />
                <NI label="TAXA DE FALHA (%)" value={fp} onChange={sFp} unit="%" />
                <NI label="VALOR DO KWH" value={ckw} onChange={sCkw} unit="R$" />
              </>
            )}

            {tab === "mdo" && (
              <>
                <NI label="VALOR DA SUA HORA" value={vhm} onChange={sVhm} unit="R$/H" />
                <NI label="SETUP / SLICER" value={tsu} onChange={sTsu} unit="MIN" />
                <NI label="P√ìS-PROCESSAMENTO" value={tpp} onChange={sTpp} unit="MIN" />
                <div style={{ marginTop: 10, padding: 15, background: "#2C2C2E", borderRadius: 12 }}>
                  <div style={{ fontSize: 11, color: "#8E8E93" }}>MARGEM DE LUCRO DESEJADA</div>
                  <input type="range" min="0" max="200" value={ml} onChange={e => sMl(e.target.value)} style={{ marginTop: 10 }} />
                  <div style={{ textAlign: "right", fontWeight: "700", color: "#0A84FF" }}>{ml}%</div>
                </div>
              </>
            )}
          </div>

          <footer style={{ marginTop: 30, textAlign: "center" }}>
            <button onClick={() => alert('DADOS SALVOS COM SUCESSO')} style={{
              width: "100%", padding: "16px", borderRadius: 16, background: "#30D158", color: "#FFF",
              border: "none", fontSize: 16, fontWeight: "800", boxShadow: "0 4px 12px rgba(48, 209, 88, 0.3)"
            }}>SALVAR NO ARQUIVO</button>
            <p style={{ fontSize: 10, color: "#48484A", marginTop: 20 }}>¬© 2026 CB¬≤K PRESENTES 3D - SISTEMA OPERACIONAL</p>
          </footer>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
