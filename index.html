<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CALCULADORA DE IMPRESS√ÉO 3D - CB¬≤K</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üñ®Ô∏è</text></svg>" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; transition: background 0.2s, color 0.2s; }
    body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; text-transform: uppercase; }
    input, textarea, select { text-transform: uppercase; }

    /* BOT√ÉO DE TEMA */
    .theme-toggle {
      position: fixed;
      top: 15px;
      right: 15px;
      z-index: 9999;
      padding: 10px 15px;
      border-radius: 20px;
      border: 1px solid rgba(128,128,128,0.3);
      cursor: pointer;
      font-weight: 800;
      font-size: 11px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
  <script type="text/babel">
    const { useState, useMemo, useEffect, useCallback } = React;

    const SK = "print3d-archive";
    async function ldA() { try { const v = localStorage.getItem(SK); return v ? JSON.parse(v) : []; } catch { return []; } }
    async function svA(items) { try { localStorage.setItem(SK, JSON.stringify(items)); } catch(e) { console.error(e); } }

    const materialData = {
      PLA: { pricePerKg: 120, density: 1.24, description: "MAIS COMUM, F√ÅCIL" },
      ABS: { pricePerKg: 140, density: 1.04, description: "RESISTENTE, INDUSTRIAL" },
      PETG: { pricePerKg: 150, density: 1.27, description: "RESISTENTE E FLEX√çVEL" },
      TPU: { pricePerKg: 200, density: 1.21, description: "BORRACHUDO" },
      RESINA: { pricePerKg: 250, density: 1.10, description: "ALTA DEFINI√á√ÉO" },
    };

    const marketplacePresets = {
      NENHUM: { label: "VENDA DIRETA", taxa: 0 },
      ML: { label: "MERCADO LIVRE", taxa: 13 },
      SHOPEE: { label: "SHOPEE", taxa: 14 },
    };

    function NI({ label, value, onChange, unit, theme }) {
      return (
        <div style={{ marginBottom: 16 }}>
          <label style={{ display: "block", fontSize: 12, fontWeight: 700, color: theme.textSec, marginBottom: 6 }}>{label}</label>
          <div style={{ display: "flex", alignItems: "center", gap: 8 }}>
            <input type="number" value={value} onChange={(e) => onChange(parseFloat(e.target.value) || 0)} 
              style={{ flex: 1, padding: "12px", borderRadius: 10, border: `1px solid ${theme.border}`, background: theme.inputBg, color: theme.text, fontSize: 16, outline: "none" }} />
            {unit && <span style={{ color: theme.textSec, fontSize: 14 }}>{unit}</span>}
          </div>
        </div>
      );
    }

    function CC({ label, value, icon, color, sub, theme }) {
      return (
        <div style={{ background: theme.cardBg, borderRadius: 16, padding: "18px", border: `1px solid ${color}44`, flex: 1, minWidth: 140 }}>
          <div style={{ fontSize: 22, marginBottom: 8 }}>{icon}</div>
          <div style={{ fontSize: 10, color: theme.textSec, fontWeight: 700 }}>{label}</div>
          <div style={{ fontSize: 18, fontWeight: 900, color }}>{value}</div>
          {sub && <div style={{ fontSize: 9, color: theme.textSec, marginTop: 4 }}>{sub}</div>}
        </div>
      );
    }

    function App() {
      const [dark, setDark] = useState(true);
      const [tab, setTab] = useState("PE√áA");
      const [pg, sPg] = useState(50), [th, sTh] = useState(4), [tm, sTm] = useState(30), [mat, sMat] = useState("PLA");
      const [ci, sCi] = useState(3000), [vu, sVu] = useState(5000), [pw, sPw] = useState(250), [ckw, sCkw] = useState(0.85);
      const [ml, sMl] = useState(50), [qtd, sQtd] = useState(1);
      const [arch, sArch] = useState([]);

      const theme = dark ? {
        bg: "#000000", cardBg: "#1C1C1E", inputBg: "#2C2C2E", text: "#FFFFFF", textSec: "#8E8E93", border: "#38383A", accent: "#0A84FF"
      } : {
        bg: "#F2F2F7", cardBg: "#FFFFFF", inputBg: "#E5E5EA", text: "#000000", textSec: "#3A3A3C", border: "#C7C7CC", accent: "#007AFF"
      };

      const c = useMemo(() => {
        const tH = th + tm / 60;
        const cMat = (pg / 1000) * materialData[mat].pricePerKg;
        const cEn = (pw / 1000) * tH * ckw;
        const dep = (ci / vu) * tH;
        const cProd = cMat + cEn + dep;
        const pFin = cProd * (1 + ml / 100) / 0.85;
        return { prod: cProd, venda: pFin, lucro: pFin - cProd };
      }, [pg, th, tm, mat, ci, vu, pw, ckw, ml]);

      const f = v => `R$ ${v.toFixed(2)}`;
      
      const tabs = [
        { id: "PE√áA", icon: "üéØ" }, { id: "OPERA√á√ÉO", icon: "‚ö°" }, 
        { id: "LUCRO", icon: "üìà" }, { id: "ARQUIVO", icon: "üóÇÔ∏è" }
      ];

      return (
        <div style={{ minHeight: "100vh", background: theme.bg, color: theme.text, padding: "20px" }}>
          <button className="theme-toggle" onClick={() => setDark(!dark)} style={{ background: theme.cardBg, color: theme.text }}>
            {dark ? "‚òÄÔ∏è CLARO" : "üåô ESCURO"}
          </button>

          <div style={{ maxWidth: 800, margin: "0 auto" }}>
            <header style={{ textAlign: "center", marginBottom: 30 }}>
              <h1 style={{ fontSize: 26, fontWeight: 900, color: theme.accent }}>CALCULADORA CB¬≤K</h1>
              <p style={{ color: theme.textSec, fontSize: 12 }}>IMPRESS√ÉO 3D - BRAS√çLIA</p>
            </header>

            <div style={{ display: "flex", gap: 12, flexWrap: "wrap", marginBottom: 25 }}>
              <CC label="VENDA" value={f(c.venda)} icon="üè∑Ô∏è" color="#30D158" theme={theme} />
              <CC label="LUCRO" value={f(c.lucro)} icon="üìà" color={theme.accent} theme={theme} />
            </div>

            {/* CORRE√á√ÉO DAS ABAS (TEXTO SEMPRE VIS√çVEL) */}
            <nav style={{ display: "flex", gap: 8, marginBottom: 20, overflowX: "auto", paddingBottom: 10 }}>
              {tabs.map(t => (
                <button key={t.id} onClick={() => setTab(t.id)} style={{
                  padding: "12px 20px", borderRadius: 14, border: "none", fontWeight: 800, fontSize: 11, cursor: "pointer", whiteSpace: "nowrap",
                  background: tab === t.id ? theme.accent : theme.cardBg,
                  color: tab === t.id ? "#FFFFFF" : theme.text // AQUI O NOME APARECE!
                }}>
                  {t.icon} {t.id}
                </button>
              ))}
            </nav>

            <div style={{ background: theme.cardBg, borderRadius: 20, padding: "25px", border: `1px solid ${theme.border}` }}>
              {tab === "PE√áA" && (
                <>
                  <NI label="PESO DA PE√áA (G)" value={pg} onChange={sPg} unit="G" theme={theme} />
                  <div style={{ display: "flex", gap: 12 }}>
                    <div style={{ flex: 1 }}><NI label="HORAS" value={th} onChange={sTh} theme={theme} /></div>
                    <div style={{ flex: 1 }}><NI label="MINUTOS" value={tm} onChange={sTm} theme={theme} /></div>
                  </div>
                  <label style={{ display: "block", fontSize: 11, fontWeight: 700, color: theme.textSec, marginBottom: 10 }}>MATERIAL</label>
                  <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 8 }}>
                    {Object.keys(materialData).map(m => (
                      <button key={m} onClick={() => sMat(m)} style={{
                        padding: "15px", borderRadius: 12, border: mat === m ? `2px solid ${theme.accent}` : `1px solid ${theme.border}`,
                        background: mat === m ? "rgba(10, 132, 255, 0.1)" : "transparent", color: theme.text, fontWeight: 700
                      }}>{m}</button>
                    ))}
                  </div>
                </>
              )}
              {tab === "OPERA√á√ÉO" && (
                <>
                  <NI label="VALOR DA M√ÅQUINA" value={ci} onChange={sCi} unit="R$" theme={theme} />
                  <NI label="CUSTO KWH" value={ckw} onChange={sCkw} unit="R$" theme={theme} />
                </>
              )}
              {tab === "LUCRO" && (
                <>
                  <label style={{ fontSize: 12 }}>MARGEM: {ml}%</label>
                  <input type="range" min="0" max="200" value={ml} onChange={e => sMl(e.target.value)} style={{ accentColor: theme.accent, marginTop: 15 }} />
                </>
              )}
            </div>

            <footer style={{ textAlign: "center", marginTop: 30, color: "#48484A", fontSize: 11 }}>
              ¬© 2026 CB¬≤K PRESENTES 3D - BRAS√çLIA
            </footer>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
