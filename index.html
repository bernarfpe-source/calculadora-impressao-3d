<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CALCULADORA 3D - CB²K</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { background: #000000; font-family: -apple-system, sans-serif; color: #FFFFFF; text-transform: uppercase; }
    input, textarea, select { text-transform: uppercase; }
    .card { background: #1C1C1E; border-radius: 14px; padding: 15px; border: 1px solid #38383A; flex: 1; min-width: 140px; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
  <script type="text/babel">
    const { useState, useMemo, useEffect } = React;

    const SK = "print3d-archive";
    const ldA = () => { const v = localStorage.getItem(SK); return v ? JSON.parse(v) : []; };
    const svA = (i) => localStorage.setItem(SK, JSON.stringify(i));

    const materialData = {
      PLA: { pricePerKg: 120, desc: "FÁCIL" },
      ABS: { pricePerKg: 140, desc: "RESISTENTE" },
      PETG: { pricePerKg: 150, desc: "FLEXÍVEL" }
    };

    function App() {
      const [pg, sPg] = useState(50), [th, sTh] = useState(4), [tm, sTm] = useState(30), [mat, sMat] = useState("PLA");
      const [ci, sCi] = useState(3000), [vu, sVu] = useState(5000), [pw, sPw] = useState(250), [ckw, sCkw] = useState(0.85);
      const [ml, sMl] = useState(50), [tab, sTab] = useState("PEÇA"), [arch, sArch] = useState([]);

      useEffect(() => { sArch(ldA()); }, []);

      const c = useMemo(() => {
        const m = materialData[mat] || materialData.PLA, tH = th + tm / 60;
        const cMat = (pg / 1000) * m.pricePerKg, cEn = (pw / 1000) * tH * ckw, dep = (ci / vu) * tH;
        const cProd = cMat + cEn + dep;
        const pFin = cProd * (1 + ml / 100) / 0.85; 
        return { cProd, pVenda: pFin, lucro: pFin - cProd };
      }, [pg, th, tm, mat, ci, vu, pw, ckw, ml]);

      const f = v => `R$ ${v.toFixed(2)}`;

      return (
        <div style={{ padding: "20px", maxWidth: "600px", margin: "0 auto" }}>
          <header style={{ textAlign: "center", marginBottom: "20px" }}>
            <h1 style={{ color: "#0A84FF" }}>CALCULADORA CB²K</h1>
            <p style={{ color: "#8E8E93", fontSize: "12px" }}>IMPRESSÃO 3D</p>
          </header>

          <div style={{ display: "flex", gap: "10px", marginBottom: "20px" }}>
            <div className="card"><div style={{fontSize:"10px", color:"#8E8E93"}}>VENDA</div><div style={{color:"#32D74B", fontWeight:"800"}}>{f(c.pVenda)}</div></div>
            <div className="card"><div style={{fontSize:"10px", color:"#8E8E93"}}>LUCRO</div><div style={{color:"#0A84FF", fontWeight:"800"}}>{f(c.lucro)}</div></div>
          </div>

          <div style={{ display: "flex", gap: "5px", marginBottom: "20px", overflowX:"auto" }}>
            {["PEÇA", "CUSTOS", "LUCRO"].map(t => (
              <button key={t} onClick={() => sTab(t)} style={{ padding: "10px", borderRadius: "10px", border: "none", background: tab === t ? "#0A84FF" : "#1C1C1E", color: "#FFF", fontWeight: "700", flex: 1 }}>{t}</button>
            ))}
          </div>

          <div style={{ background: "#1C1C1E", borderRadius: "15px", padding: "20px", border: "1px solid #38383A" }}>
            {tab === "PEÇA" && (
              <>
                <label style={{color:"#8E8E93", fontSize:"11px"}}>PESO (G)</label>
                <input type="number" value={pg} onChange={e => sPg(parseFloat(e.target.value)||0)} style={{ width: "100%", padding: "12px", background: "#2C2C2E", border: "none", borderRadius: "8px", color: "#FFF", marginBottom: "15px" }} />
                <div style={{ display: "flex", gap: "10px" }}>
                  <div style={{flex:1}}><label style={{color:"#8E8E93", fontSize:"11px"}}>HORAS</label><input type="number" value={th} onChange={e => sTh(parseFloat(e.target.value)||0)} style={{ width: "100%", padding: "12px", background: "#2C2C2E", border: "none", borderRadius: "8px", color: "#FFF" }} /></div>
                  <div style={{flex:1}}><label style={{color:"#8E8E93", fontSize:"11px"}}>MIN</label><input type="number" value={tm} onChange={e => sTm(parseFloat(e.target.value)||0)} style={{ width: "100%", padding: "12px", background: "#2C2C2E", border: "none", borderRadius: "8px", color: "#FFF" }} /></div>
                </div>
              </>
            )}
            {tab === "CUSTOS" && (
              <>
                <label style={{color:"#8E8E93", fontSize:"11px"}}>VALOR MÁQUINA</label>
                <input type="number" value={ci} onChange={e => sCi(parseFloat(e.target.value)||0)} style={{ width: "100%", padding: "12px", background: "#2C2C2E", border: "none", borderRadius: "8px", color: "#FFF", marginBottom: "15px" }} />
                <label style={{color:"#8E8E93", fontSize:"11px"}}>KWH R$</label>
                <input type="number" value={ckw} onChange={e => sCkw(parseFloat(e.target.value)||0)} style={{ width: "100%", padding: "12px", background: "#2C2C2E", border: "none", borderRadius: "8px", color: "#FFF" }} />
              </>
            )}
            {tab === "LUCRO" && (
              <>
                <label style={{color:"#8E8E93", fontSize:"11px"}}>MARGEM: {ml}%</label>
                <input type="range" min="0" max="200" value={ml} onChange={e => sMl(e.target.value)} style={{ width: "100%", accentColor: "#0A84FF" }} />
              </>
            )}
          </div>
          <footer style={{textAlign:"center", marginTop:"20px", color:"#48484A", fontSize:"10px"}}>CB²K PRESENTES 3D - BRASÍLIA</footer>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
