<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CALCULADORA DE IMPRESS√ÉO 3D - CB¬≤K</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üñ®Ô∏è</text></svg>" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { background: #000000; font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; color: #FFFFFF; }
    input, textarea, select { text-transform: uppercase; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
  <script type="text/babel">
    const { useState, useMemo, useEffect, useCallback } = React;

    const SK = "print3d-archive";
    async function ldA() { try { const v = localStorage.getItem(SK); return v ? JSON.parse(v) : []; } catch { return []; } }
    async function svA(items) { try { localStorage.setItem(SK, JSON.stringify(items)); } catch(e) { console.error(e); } }

    const materialData = {
      PLA: { pricePerKg: 120, density: 1.24, description: "MAIS COMUM, F√ÅCIL DE IMPRIMIR" },
      ABS: { pricePerKg: 140, density: 1.04, description: "RESISTENTE, USO INDUSTRIAL" },
      PETG: { pricePerKg: 150, density: 1.27, description: "RESISTENTE E FLEX√çVEL" },
      TPU: { pricePerKg: 200, density: 1.21, description: "FLEX√çVEL, BORRACHUDO" },
      NYLON: { pricePerKg: 280, density: 1.14, description: "ALTA RESIST√äNCIA MEC√ÇNICA" },
      RESINA: { pricePerKg: 250, density: 1.10, description: "ALTA DEFINI√á√ÉO (SLA/DLP)" },
      ASA: { pricePerKg: 180, density: 1.07, description: "RESISTENTE A UV, USO EXTERNO" },
      PC: { pricePerKg: 300, density: 1.20, description: "POLICARBONATO, ALTA RESIST√äNCIA" },
    };
    const marketplacePresets = {
      NENHUM: { label: "VENDA DIRETA", taxa: 0, desc: "SEM MARKETPLACE" },
      MERCADOLIVRE: { label: "MERCADO LIVRE", taxa: 13, desc: "~11-16% S/ CATEGORIA" },
      SHOPEE: { label: "SHOPEE", taxa: 14, desc: "~12-18% + COMISS√ÉO" },
      AMAZON: { label: "AMAZON", taxa: 15, desc: "~8-20% S/ CATEGORIA" },
      CUSTOM: { label: "PERSONALIZADO", taxa: 0, desc: "DEFINA SUA TAXA" },
    };
    const statusOptions = [
      { id: "verificada", label: "VERIFICADA", color: "#30D158", icon: "‚úÖ" },
      { id: "pendente", label: "PENDENTE", color: "#FFD60A", icon: "‚è≥" },
      { id: "problema", label: "PROBLEMA", color: "#FF453A", icon: "‚ö†Ô∏è" },
      { id: "favorita", label: "FAVORITA", color: "#AF52DE", icon: "‚≠ê" },
    ];

    function NI({ label, value, onChange, unit, step = 1, min = 0, helpText }) {
      return (
        <div style={{ marginBottom: 16 }}>
          <label style={{ display: "block", fontSize: 13, fontWeight: 600, color: "#8E8E93", marginBottom: 6, letterSpacing: "0.5px", textTransform: "uppercase" }}>{label}</label>
          <div style={{ display: "flex", alignItems: "center", gap: 8 }}>
            <input type="number" value={value} onChange={(e) => onChange(parseFloat(e.target.value) || 0)} step={step} min={min}
              style={{ flex: 1, padding: "10px 14px", borderRadius: 10, border: "1px solid #38383A", background: "#1C1C1E", color: "#FFFFFF", fontSize: 16, outline: "none" }} />
            {unit && <span style={{ color: "#8E8E93", fontSize: 14, minWidth: 30 }}>{unit}</span>}
          </div>
          {helpText && <span style={{ fontSize: 11, color: "#636366", marginTop: 4, display: "block" }}>{helpText}</span>}
        </div>
      );
    }

    function SI({ label, value, onChange, min, max, step = 1, unit = "%", helpText }) {
      return (
        <div style={{ marginBottom: 16 }}>
          <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 6 }}>
            <label style={{ fontSize: 13, fontWeight: 600, color: "#8E8E93", letterSpacing: "0.5px", textTransform: "uppercase" }}>{label}</label>
            <span style={{ fontSize: 15, fontWeight: 700, color: "#0A84FF" }}>{value + unit}</span>
          </div>
          <input type="range" min={min} max={max} step={step} value={value} onChange={(e) => onChange(parseFloat(e.target.value))} style={{ width: "100%", accentColor: "#0A84FF" }} />
          {helpText && <span style={{ fontSize: 11, color: "#636366", marginTop: 2, display: "block" }}>{helpText}</span>}
        </div>
      );
    }

    function CC({ label, value, icon, color = "#0A84FF", sub }) {
      return (
        <div style={{ background: "#1C1C1E", borderRadius: 14, padding: "14px 16px", border: `1px solid ${color}44`, flex: 1, minWidth: 120 }}>
          <div style={{ fontSize: 20, marginBottom: 4 }}>{icon}</div>
          <div style={{ fontSize: 10, color: "#8E8E93", textTransform: "uppercase", letterSpacing: "0.5px", marginBottom: 3 }}>{label}</div>
          <div style={{ fontSize: 18, fontWeight: 800, color }}>{value}</div>
          {sub && <div style={{ fontSize: 10, color: "#636366", marginTop: 3 }}>{sub}</div>}
        </div>
      );
    }

    function App() {
      const [pg, sPg] = useState(50), [th, sTh] = useState(4), [tm, sTm] = useState(30), [mat, sMat] = useState("PLA");
      const [ci, sCi] = useState(3000), [vu, sVu] = useState(5000), [pw, sPw] = useState(250), [ckw, sCkw] = useState(0.85);
      const [inf, sInf] = useState(20), [fp, sFp] = useState(5);
      const [lix, sLix] = useState(false), [pin, sPin] = useState(false), [acab, sAcab] = useState(false), [sup, sSup] = useState(true);
      const [vhm, sVhm] = useState(30), [tsu, sTsu] = useState(15), [tpp, sTpp] = useState(20);
      const [ml, sMl] = useState(50), [qtd, sQtd] = useState(1), [cfm, sCfm] = useState(200), [hm, sHm] = useState(200);
      const [ff, sFf] = useState(15), [fpc, sFpc] = useState(true), [ce, sCe] = useState(3);
      const [rt, sRt] = useState("mei"), [ac, sAc] = useState(6), [mk, sMk] = useState("NENHUM"), [tmc, sTmc] = useState(15), [tfm, sTfm] = useState(0);
      const [tab, sTab] = useState("peca"), [arch, sArch] = useState([]), [aLoad, sALoad] = useState(true);
      const [nome, sNome] = useState(""), [notas, sNotas] = useState(""), [status, sStatus] = useState("verificada"), [search, sSearch] = useState(""), [filt, sFilt] = useState("todos"), [sort, sSort] = useState("data"), [cdel, sCdel] = useState(null), [saved, sSaved] = useState(false);

      useEffect(() => { ldA().then(i => { sArch(i); sALoad(false); }); }, []);

      const aImp = useMemo(() => ({ mei:5, simples:6, presumido:11.33, real:15, informal:0, custom:ac })[rt] ?? 5, [rt, ac]);
      const tMk = useMemo(() => mk === "NENHUM" ? 0 : mk === "CUSTOM" ? tmc : marketplacePresets[mk]?.taxa || 0, [mk, tmc]);

      const c = useMemo(() => {
        const m = materialData[mat] || materialData.PLA, tH = th + tm / 60;
        const cMat = (pg / 1000) * m.pricePerKg, cEn = (pw / 1000) * tH * ckw, dep = (ci / vu) * tH;
        const cMdo = ((tsu + tpp) / 60) * vhm;
        let cPos = 0; if (lix) cPos += 2.5; if (pin) cPos += 8; if (acab) cPos += 5; if (sup) cPos += 1.5;
        const cFalha = (cMat + cEn) * (fp / 100), rCF = (cfm / hm) * tH, cEmb = ce, cFr =
